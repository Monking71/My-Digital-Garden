---
{"dg-publish":true,"permalink":"/leeds-university/computer-science/compulsory-modules/databases/9-transaction-management/9-transaction-management/"}
---

**Why do we care?**
- How many users/database operations are accessing the database system at one time
- How sure are you that there won’t be any incidents affecting the data in the database? e.g. system crash, media failure, error in program? How about sabotage?
- DBMS provides concurrency control and database recovery
#### Transaction Support
**What is a transaction?**
- An action, or series of actions, carried out by a user or application, which reads or updates contents of a database
- Logical unit of work on the database
- An/The? Application program is a series of transactions with non-database processing in between
- Transforms the database from one consistent state to another, although consistency may be violated during transaction

- Can have one or two outcomes:
	- **Success** – the transaction commits and the database reaches a new consistent state
	- **Failure** – the transaction aborts, and the database must be restored to a consistent state before it is started
		- Such a transaction is rolled back or undone
- A committed transaction cannot be aborted
- An aborted transaction that is rolled back can be restarted later
![Example Transaction.png](/img/user/Leeds%20University/Computer%20Science/Compulsory%20Modules/Databases/9.%20Transaction%20Management/images/Example%20Transaction.png)
#### Properties of Transactions
There are four basic (***ACID***) properties that define a transaction:
- **Atomicity** – ‘All or nothing’ property
- **Consistency** – Must transform the database from one consistent state to another
- **Isolation** – Partial effects of incomplete transactions should not be visible to other transactions
- **Durability** – Effects of a committed transaction are permanent and must not be lost because of later
#### Concurrency Control
The process of managing simultaneous operations on the database without having them interfere with one another
- Prevents interference when two or more users are accessing database simultaneously and at least one is updating data
- Although two transactions may be correct in themselves, interleaving of operations may produce an incorrect result
**Need for Concurrency Control**
Three examples of potential problems caused by concurrency:
- Lost update problem
- Uncommitted dependency problem
- Inconsistent analysis problem
##### Lost Update Problems
A successfully completed update is overridden by another user
![Lost Update Problem.png](/img/user/Leeds%20University/Computer%20Science/Compulsory%20Modules/Databases/9.%20Transaction%20Management/images/Lost%20Update%20Problem.png)
	- Loss of $T_{2}$’s update avoided by preventing $T_{1}$ from reading $\text{bal}_{x}$ until after update
##### Uncommitted Dependency Problem
Occurs when one transaction can see intermediate results of another transaction before it has committed
![Uncommitted Dependency Problem.png](/img/user/Leeds%20University/Computer%20Science/Compulsory%20Modules/Databases/9.%20Transaction%20Management/images/Uncommitted%20Dependency%20Problem.png)
	- Problem avoided by preventing $T_{3}$ from reading $\text{bal}_{x}$ until after $T_{4}$ commits or aborts
##### Inconsistent Analysis Problems
Occurs when a transaction reads several values but a second transaction updates some of them during the execution of the first
![Inconsistent Analysis Problem.png](/img/user/Leeds%20University/Computer%20Science/Compulsory%20Modules/Databases/9.%20Transaction%20Management/images/Inconsistent%20Analysis%20Problem.png)
	- Problem avoided by preventing $T_{6}$ from reading $\text{bal}_{x}$ and $\text{bal}_{z}$ until after $T_{5}$ completed updates
##### Serialisability
The objective of a concurrency control protocol is to schedule non-interfering transactions
- Serialisability as a means of helping to identify those executions of transactions that are guaranteed to ensure consistency, as if the transactions are run in serial execution
**Why all these troubles? Recovery!**
- If a transaction in a schedule fails, it should be undone
- The DBMS does not test for serialisability of a schedule as the interleaving of operations is determined by the OS
- DBMS $\rightarrow$ concurrency control techniques to achieve serialisability
##### Concurrency Control Techniques
Two basic concurrency control techniques
- Locking
- Time-stamping
Both are conservative approaches: delay transactions in case they conflict with other transactions
Optimistic methods assume conflict is rare and only check for conflicts at commit
###### Locking
